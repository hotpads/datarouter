package com.hotpads.datarouter.test.client.insert.generated;

import java.util.List;

import javax.inject.Inject;
import javax.inject.Singleton;

import com.hotpads.datarouter.client.ClientId;
import com.hotpads.datarouter.node.factory.NodeFactory;
import com.hotpads.datarouter.node.op.combo.SortedMapStorage;
import com.hotpads.datarouter.routing.BaseDatarouter;
import com.hotpads.datarouter.routing.DatarouterContext;
import com.hotpads.datarouter.test.DRTestConstants;
import com.hotpads.datarouter.test.client.insert.generated.managed.PutOpIdGeneratedManagedTestBean;
import com.hotpads.datarouter.test.client.insert.generated.managed.PutOpIdGeneratedManagedTestBean.PutOpIdGeneratedManagedTestBeanFielder;
import com.hotpads.datarouter.test.client.insert.generated.managed.PutOpIdGeneratedManagedTestBeanKey;
import com.hotpads.datarouter.test.client.insert.generated.random.PutOpIdGeneratedRandomTestBean;
import com.hotpads.datarouter.test.client.insert.generated.random.PutOpIdGeneratedRandomTestBean.PutOpIdGeneratedRandomTestBeanFielder;
import com.hotpads.datarouter.test.client.insert.generated.random.PutOpIdGeneratedRandomTestBeanKey;
import com.hotpads.util.core.ListTool;

@Singleton
public class AutoGeneratedIdTestRouter extends BaseDatarouter{
	
	private static final String NAME = "autoGeneratedIdTestRouter";

	
	public SortedMapStorage<PutOpIdGeneratedManagedTestBeanKey, PutOpIdGeneratedManagedTestBean> putOpIdGeneratedManaged;
	public SortedMapStorage<PutOpIdGeneratedRandomTestBeanKey, PutOpIdGeneratedRandomTestBean> putOpIdGeneratedRandom;

	@Inject
	public AutoGeneratedIdTestRouter(DatarouterContext context, NodeFactory nodeFactory){
		super(context, DRTestConstants.CONFIG_PATH, NAME);
		
		putOpIdGeneratedManaged = cast(register(nodeFactory.create(DRTestConstants.CLIENT_drTestJdbc0,
				PutOpIdGeneratedManagedTestBean.class, PutOpIdGeneratedManagedTestBeanFielder.class, this, false)));
		putOpIdGeneratedRandom = cast(register(nodeFactory.create(DRTestConstants.CLIENT_drTestJdbc0,
				PutOpIdGeneratedRandomTestBean.class, PutOpIdGeneratedRandomTestBeanFielder.class, this, false)));
		
		registerWithContext();
	}

	@Override
	public List<ClientId> getClientIds(){
		return ListTool.create(new ClientId(DRTestConstants.CLIENT_drTestJdbc0, true));
	}

}
